<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	template="../../templates/default.xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html">
	
	<ui:define name="script">
		$(document).ready(function() {  
			
		}); 
  	</ui:define>
	
	<ui:define name="content"> 
		<h:form prependId="false">
		
			<p:messages id="messages" showDetail="false" autoUpdate="false" closable="true" />  
			<p:growl id="grlMessages" showDetail="false" autoUpdate="false" closable="true" /> 
												
			<p:tabView id="tvBranch" style="height: 300px;"> 
				<p:tab id="tabBranch" title="#{msg.resolve('tab.branch.register.branch')}">
					<p:spacer width="20" height="15"/>
				
					<h:panelGroup id="pgroupBranch"> 
						<h:panelGrid id="pgBranch" columns="3" cellspacing="5" cellpadding="5">
								<h:outputLabel value="#{msg.resolve('label.branch.code')}" for="txtCode"/>
								<p:inputText id="txtCode" value="#{branchBean.branchSearch.code}" maxlength="8"
										required="true" size="10"  requiredMessage="#{msg.resolveMsg('required.field', 'label.branch.code')}"/>
										
								<p:commandLink id="lnkSearchCode" title="#{msg.resolve('label.search')}" actionListener="#{branchBean.loadBranch}"
										process="@this, tvBranch:txtCode" update="pgFound, messages" ajax="true">
									<h:graphicImage name="search.png" library="images"/>
								</p:commandLink>
						
								<h:outputLabel value="#{msg.resolve('label.aregional.code')}" for="txtARegionalCode"/>
								<p:inputText id="txtARegionalCode" value="#{branchBean.branchSearch.aRegionalCode}" maxlength="8"
											required="true" size="10" requiredMessage="#{msg.resolveMsg('required.field','label.aregional.code')}"/>
									 		
								<p:commandLink id="lnkSearchARegional" title="#{msg.resolve('label.search')}" actionListener="#{branchBean.loadARegional}"
										process="@this, tvBranch:txtARegionalCode" update="pgFound, messages" ajax="true">
									<h:graphicImage name="search.png" library="images"/>
								</p:commandLink>
						</h:panelGrid>
					</h:panelGroup>	
					
					<p:spacer width="2" height="5"/>
					<p:separator style="width: 35%; text-align: left;"/>
					<p:spacer width="2" height="5"/>
					 
					<h:panelGroup id="pgFound">
						<h:panelGrid columns="2" cellpadding="5" cellspacing="5">
								<h:outputLabel value="#{msg.resolve('label.branch.code')}" for="txtBranchCode">
									<p:spacer width="2" height="2"/>
								</h:outputLabel>
								<p:inputText id="txtBranchCode" value="#{branchBean.branch.code}" maxlength="10"
									disabled="#{branchBean.disabledBranchCode}" required="true" size="10" 
									requiredMessage="#{msg.resolveMsg('required.field', 'label.center.value')}"/>
						
								<h:outputLabel value="#{msg.resolve('label.center.value')}" for="txtCenterValue"/>
								<p:inputMask id="txtCenterValue" value="#{branchBean.branch.centerValue}" 
									maxlength="10" required="true" size="15" mask="9999999999"
									requiredMessage="#{msg.resolveMsg('required.field', 'label.center.value')}"/>
								
								<h:outputLabel value="#{msg.resolve('label.name')}" for="txtName"/>
								<p:inputText id="txtName" value="#{branchBean.branch.name}" disabled="#{branchBean.disabledName}" maxlength="80"
										required="true" size="40" requiredMessage="#{msg.resolveMsg('required.field', 'branchBean.branch.name')}" />

								<h:outputLabel value="#{msg.resolve('label.aregional.code')}" for="txtCodeARegional"/>
								<p:inputText id="txtCodeARegional" value="#{branchBean.aRegional.code}" maxlength="10"
										disabled="#{branchBean.disabledARegionalCode}" required="true" size="10" 
										requiredMessage="#{msg.resolveMsg('required.field', 'label.regional.code')}"/>
										
								<h:outputLabel value="#{msg.resolve('label.aregional.name')}" for="txtARegionalName"/>
								<p:inputText id="txtARegionalName" value="#{branchBean.aRegional.name}" 
									disabled="#{branchBean.disabledARegionalName}" required="true" size="40" 
									requiredMessage="#{msg.resolveMsg('required.field', 'label.aregional.name')}"/>
						</h:panelGrid>
					</h:panelGroup>
					
				</p:tab>
				<p:tab  id="tabManagerRegional" title="#{msg.resolve('tab.branch.register.regional')}">
					<p:spacer width="20" height="15"/>
					
					<h:panelGrid id="pgManagerRegional" columns="3" cellspacing="5" cellpadding="8">
							
							<h:outputLabel value="#{msg.resolve('label.without.manager')}" for="chkWithoutManager"/>
							<p:selectBooleanCheckbox id="chkWithoutManager"	value="#{branchBean.branch.withoutmanager}">  
							            <p:ajax process="@this" update="tvBranch:pgCollaborators, pgManagerRegional" /> 
							</p:selectBooleanCheckbox>
							<p:spacer height="2" width="2"/>
					
							<h:outputLabel value="#{msg.resolve('label.regional.registry')}" for="txtRegionalRegistry"/>
							<p:inputText id="txtRegionalRegistry" value="#{branchBean.branchSearch.regionalRegister}" maxlength="10"
										required="true" size="11" requiredMessage="#{msg.resolveMsg('required.field','label.regional.registry')}"/>
										
							<p:commandLink id="lnkSearchRegional" title="#{msg.resolve('label.search')}" oncomplete="dlgSearchCollaborators.show()"
									actionListener="#{branchBean.searchType('R')}" immediate="true"
									process="@this" ajax="true">
								<h:graphicImage name="search.png" library="images"/>
							</p:commandLink>
							
							<h:outputLabel value="#{msg.resolve('label.manager.registry')}" for="txtManagerRegistry" />
							<p:inputText id="txtManagerRegistry" value="#{branchBean.branchSearch.managerRegister}" maxlength="10"
										required="true" size="11" requiredMessage="#{msg.resolveMsg('required.field', 'label.manager.registry')}"
										disabled="#{branchBean.branch.withoutmanager}"/>
							
							<p:commandLink id="lnkSearchManager" title="#{msg.resolve('label.search')}" oncomplete="dlgSearchCollaborators.show()"
									actionListener="#{branchBean.searchType('M')}" disabled="#{branchBean.branch.withoutmanager}"
									process="@this" ajax="true" immediate="true">
								<h:graphicImage name="search.png" library="images"/>
							</p:commandLink>
					</h:panelGrid>
					
					<p:spacer width="2" height="5"/>
					<p:separator style="width: 35%; text-align: left;"/>
					<p:spacer width="2" height="5"/>
					
					<h:panelGrid id="pgCollaborators" columns="2" cellpadding="5" cellspacing="5">
							<h:outputLabel value="#{msg.resolve('label.regional.code')}" for="txtDirCode">
								<p:spacer width="40" height="2"/>
							</h:outputLabel>
							<p:inputText id="txtDirCode" value="#{branchBean.regional.code}" maxlength="10"
									disabled="#{branchBean.disabledDirCode}" required="true" size="10" 
									requiredMessage="#{msg.resolveMsg('required.field', 'label.regional.code')}">
								<p:ajax event="blur" process="@this"/>
							</p:inputText>		
						
							<h:outputLabel value="#{msg.resolve('label.regional.name')}" for="txtRegionalName"/>
							<p:inputText id="txtRegionalName" value="#{branchBean.regional.name}" maxlength="80"
								disabled="#{branchBean.disabledRegionalName}" required="true" size="40" 
								requiredMessage="#{msg.resolveMsg('required.field', 'label.regional.name')}"/>
							
							<h:outputLabel value="#{msg.resolve('label.manager.code')}" for="txtManagerCode"/>
							<p:inputText id="txtManagerCode" value="#{branchBean.manager.code}" maxlength="10"
									disabled="#{branchBean.disabledManagerCode}" required="true" size="10" 
									requiredMessage="#{msg.resolveMsg('required.field', 'label.manager.code')}"/>
					
							<h:outputLabel value="#{msg.resolve('label.manager.name')}" for="txtManagerName"/>
							<p:inputText id="txtManagerName" value="#{branchBean.manager.name}" maxlength="80"
									disabled="#{branchBean.disabledManagerName}"	required="true" size="40" 
									requiredMessage="#{msg.resolveMsg('required.field', 'label.manager.name')}"/>
					</h:panelGrid>
					
				</p:tab>	
				<p:tab  id="tabFieldSup" title="#{msg.resolve('tab.branch.register.field.supervisor')}" rendered="false">
					<p:spacer width="20" height="15"/>
				
					<h:panelGrid id="pgFieldSup" columns="3" cellspacing="5">
							<h:outputLabel value="#{msg.resolve('label.field.supervisor.registry')}" for="txtFieldSupervisor"/>
							<p:inputText id="txtFieldSupervisor" value="#{branchBean.branchSearch.managerRegister}" maxlength="10"
										required="true" size="11" requiredMessage="#{msg.resolveMsg('required.field', 'label.field.supervisor.registry')}"/>
							
							<p:commandLink id="lnkSearchFieldSup" title="#{msg.resolve('label.search')}"
									process="@this, tvBranch:txtFieldSupervisor" update="tvBranch:txtFieldSupervisor, messages" ajax="true">
								<h:graphicImage name="search.png" library="images"/>
							</p:commandLink>
					</h:panelGrid>		
					
					<p:spacer width="2" height="5"/>
					<p:separator style="width: 35%; text-align: left;"/>
					<p:spacer width="2" height="5"/>
					
					<h:panelGrid id="pgFieldSupResult" columns="2" cellspacing="5" cellpadding="5">
							<h:outputLabel value="#{msg.resolve('label.field.supervisor.nome')}" for="txtFieldSupervisorName"/>
							<p:inputText id="txtFieldSupervisorName" value="#{branchBean.branch.fieldSupervisor.name}"
										disabled="true" size="40"  maxlength="80" />
							
							<h:outputLabel value="#{msg.resolve('label.field.supervisor.email')}" for="txtFieldSupervisorEmail"/>
							<p:inputText id="txtFieldSupervisorEmail" value="#{branchBean.branch.fieldSupervisor.email}"
										disabled="true" size="30"  maxlength="80" />
					</h:panelGrid>	
					
				</p:tab>
			</p:tabView>
			
			<h:panelGrid columns="1" style="width: 100%; text-align:right !important;">
				<p:spacer width="100%" height="10"/>	
			 	<h:panelGroup>			 
			 		<p:commandButton id="btnCancel" immediate="true" ajax="false" image="ui-icon ui-icon-close"
			 					value="#{msg.resolve('label.cancel')}" action="#{branchBean.linkRedirect()}"/>
					
					<p:spacer width="5"/>
					
					<p:commandButton id="btnSave" process="@this, tvBranch:pgFound, tvBranch:pgCollaborators" 
								update="messages, grlMessages" 
								oncomplete="branchSaveCompleteHandle(xhr, status, args);"
								image="ui-icon ui-icon-disk"
								value="#{msg.resolve('label.save')}" actionListener="#{processorBean.save}"/>
				</h:panelGroup>
			</h:panelGrid>
			
			<p:confirmDialog widgetVar="cdlgSaveConfirm" severity="alert" closable="false"
					header="#{msg.resolve('dialog.header.new.branch')}" message="#{msg.resolve('dialog.message.branch')}" >
					
				<h:panelGrid columns="1" style="width: 100%; text-align:right !important;">
				 	<h:panelGroup>			
						<p:commandButton id="btnYes" value="#{msg.resolve('label.yes')}" process="@this" 
								update="tvBranch, tvBranch:messages" oncomplete="cdlgSaveConfirm.hide()"  actionListener="#{branchBean.clear}" />  
								
	       				<p:commandButton id="btnNo" value="#{msg.resolve('label.no')}" process="@this" update="tvBranch:messages" 
	       						oncomplete="cdlgSaveConfirm.hide()" action="#{branchBean.linkRedirect}" immediate="true" ajax="false" />
					</h:panelGroup>
				</h:panelGrid>			
       				
			</p:confirmDialog>
			
			<p:dialog id="dlgSearchCollaborator" widgetVar="dlgSearchCollaborators" modal="true" closable="true" width="500"
						header="#{branchBean.searchTitle}" resizable="false">
						
				<p:messages id="dlgMessages" showDetail="false" autoUpdate="true" closable="true" />  
				
				<p:spacer width="20" height="10"/>
			
				<h:panelGroup id="pGroupSearch">
						
						<h:panelGrid columns="2" cellpadding="3" cellspacing="6">
							<p:selectOneRadio id="typeperson" value="#{branchBean.typePerson}" onchange="changeMasks()">   
	           					<f:selectItem itemLabel="#{msg.resolve('label.radio.person.contact')}" itemValue="F" />
								<f:selectItem itemLabel="#{msg.resolve('label.radio.person.legal')}" itemValue="J"/>
							</p:selectOneRadio>
						</h:panelGrid>
						
						<h:panelGrid columns="4" cellpadding="3" cellspacing="6">
						
							<h:outputLabel value="#{msg.resolve('label.cpf.cnpj')}" />
							<h:panelGrid columns="1">
								<p:inputText id="txtSearchCPF" size="18" mask="999.999.999-99"
										value="#{branchBean.branchSearch.cpf}"/>
								<p:inputText id="txtSearchCNPJ" size="20" mask="99.999.999/9999-99"
										value="#{branchBean.branchSearch.cnpj}"/>
							</h:panelGrid>
							
							<h:outputLabel value="#{msg.resolve('label.registry')}" for="txtSearchRegistry"/>
							<p:inputText id="txtSearchRegistry" size="15" maxlength="10"
									value="#{branchBean.branchSearch.register}"/>
							
						</h:panelGrid>
						
						<h:panelGrid columns="3" cellpadding="1" cellspacing="3">
							<h:outputLabel value="#{msg.resolve('label.email')}" for="txtSearchEmail">
								<p:spacer height="2" width="30"/>
							</h:outputLabel>
							<p:inputText id="txtSearchEmail" size="47" maxlength="40" 
										value="#{branchBean.branchSearch.email}"/>
						
							<p:commandLink title="#{msg.resolve('label.add')}" actionListener="#{branchBean.loadCollaborator}"
										process="@this, pGroupSearch">
									<h:graphicImage name="busca.png" library="images"/>
							</p:commandLink>							
						</h:panelGrid>						
				</h:panelGroup>
				
				<p:spacer width="20" height="20"/>
				
				<h:panelGroup id="pgroupAdms">
					<p:dataTable id="dtCollaborators" style="width: 98%;" 
								var="colaborator" value="#{branchBean.result}"  
							    emptyMessage="#{msg.resolve('data.table.empty')}"  rows="5" paginator="true" paginatorAlwaysVisible="false"
								paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}" paginatorPosition="bottom">
										
							<f:facet name="header">  
					            <h:outputLabel value="#{branchBean.searchTitle}" />
					        </f:facet>  
					        
					        <p:column headerText="#{msg.resolve('label.registry')}" style="text-align: center;">  
					            <h:outputText value="#{colaborator.registry}"/>  
					        </p:column> 
					        
					        <p:column headerText="#{msg.resolve('label.name')}" style="text-align: left;">  
					            <h:outputText value="#{colaborator.name}"/>  
					        </p:column>  
					        
					        <p:column headerText="#{msg.resolve('label.cpf.cnpj')}" style="text-align: center;">  
					            <h:outputText value="#{colaborator.cpfFormatted}"/>  
					        </p:column>  
					        
					        <p:column style="text-align: center;">  
					            <p:commandLink title="#{msg.resolve('label.select')}" immediate="true"
					            			process="@this" update="tvBranch:pgCollaborators, tvBranch:messages"
					            			oncomplete="dlgSearchCollaborators.hide()">
									<h:graphicImage name="edit.png" library="images"/>
								</p:commandLink>
					        </p:column>  
					</p:dataTable>
				</h:panelGroup>
				
				<p:spacer width="20" height="10"/>
				
				<h:panelGrid columns="1" style="width: 99%; text-align:right !important;">
					<p:spacer width="100%" height="10"/>	
				 	<h:panelGroup>			
						<p:commandButton id="btnOk" process="@this" update="tvTeamSeller:pgAdm" actionListener="#{teamSellerBean.renewAdmSearch}"
								value="#{msg.resolve('label.ok')}" oncomplete="dlgAdministratives.hide();" />
					</h:panelGroup>
				</h:panelGrid>
				
				<p:spacer width="20" height="10"/>
				
			</p:dialog>
			
		</h:form>
	</ui:define>
</ui:composition>
