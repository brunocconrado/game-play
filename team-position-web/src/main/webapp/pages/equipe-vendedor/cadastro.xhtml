<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	template="../../templates/default.xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html">
	
	<ui:define name="content"> 
		<h:form prependId="false"> 
			<p:messages id="messages" showDetail="false" autoUpdate="false" closable="true" />
			<p:growl id="grlMessages" showDetail="false" autoUpdate="false" closable="true" />
			
			<p:tabView id="tvTeamSeller" style="height: 325px;" activeIndex="#{teamSellerBean.tabIndex}"> 
				<p:tab id="tabMainInformation" title="#{msg.resolve('tab.branch.administrative.register')}">
					<p:spacer width="20" height="15"/>
				
					<h:panelGroup id="pgroupAta">
						<h:panelGrid columns="2" cellpadding="5" cellspacing="5">
								
								<h:outputLabel value="#{msg.resolve('label.supervisor.fired')}" for="ckxSellerFired"/>
								
								<p:selectBooleanCheckbox id="ckxSellerFired" disabled="#{teamSellerBean.teamSeller.managerTeam}"
										value="#{teamSellerBean.teamSeller.supervisorFired}">  
							            <p:ajax process="@this" update="tvTeamSeller" listener="#{teamSellerBean.supervisorIsFired}"/>  
							    </p:selectBooleanCheckbox>
							     
							    <h:outputLabel value="#{msg.resolve('label.supervisor.manager.team')}" for="ckxManagerTeam"/>
								<p:selectBooleanCheckbox id="ckxManagerTeam" disabled="#{teamSellerBean.teamSeller.supervisorFired}"
										value="#{teamSellerBean.teamSeller.managerTeam}">  
							            <p:ajax process="@this" update="tvTeamSeller, pgroupAta" listener="#{teamSellerBean.changeTab(0)}"/>  
							    </p:selectBooleanCheckbox>
						</h:panelGrid>

						<p:separator style="width: 400px; text-align: left;"/>
						<p:spacer width="20" height="15"/>
								
						<h:panelGrid columns="2" cellpadding="5" cellspacing="5">
																				
								<h:outputLabel value="#{msg.resolve('label.branch')}" for="cbxBranch">
									<p:spacer  width="58" height="2"/>
								</h:outputLabel>
								
								<p:selectOneMenu id="cbxBranch" required="false" value="#{teamSellerBean.branchIdSelected}" style="width: 250px;">
									<f:selectItem itemLabel="#{msg.resolve('select.one.option')}"/>  
									<f:selectItems value="#{teamSellerBean.branches}" 
											var="branch" itemValue="#{branch.id}"
											itemLabel="#{branch.code} - #{branch.name}"/> 
										<p:ajax process="@this" listener="#{teamSellerBean.findAdministratives}"
												 update="tvTeamSeller, pgroupAta, tvTeamSeller:pgAdm, dtAdministratives" />  
								</p:selectOneMenu> 
								
						</h:panelGrid>
					</h:panelGroup>
					
					<h:panelGrid id="pgAdm" columns="3" cellpadding="2" cellspacing="5">
																				
							<h:outputLabel value="#{msg.resolve('label.administratives')}" for="txtAdministratives"/>
							<p:inputText id="txtAdministratives" disabled="true" size="50" title="#{teamSellerBean.administrativesString}"
										value="#{teamSellerBean.administrativesString()}"/>
							
							<p:commandLink title="#{msg.resolve('label.search')}" oncomplete="dlgAdministratives.show()" immediate="true">
									<h:graphicImage name="search.png" library="images"/>
							</p:commandLink>
					</h:panelGrid>
					
				</p:tab>
				<p:tab id="tabSellerInformation" title="#{msg.resolve('tab.team.seller.seller.information')}"
						rendered="#{!teamSellerBean.teamSeller.supervisorFired and teamSellerBean.branchIdSelected != null}">
						
						<p:spacer width="20" height="15"/>
						
						<h:panelGroup id="pgroupSearchSeller">
							<h:panelGrid columns="5" cellpadding="1" cellspacing="5">
								<h:outputLabel value="#{msg.resolve('label.registry')}" for="txtSellerSearchRegistry">
									<p:spacer width="32px" height="2px"/>
								</h:outputLabel>
								<p:inputText id="txtSellerSearchRegistry" size="10" maxlength="10"
										value="#{teamSellerBean.sellerSearch.registry}"/>
							
								<h:outputLabel value="#{msg.resolve('label.cpf')}" for="txtSearchCPF"/>
								<p:inputMask id="txtSearchCPF" size="15" mask="999.999.999-99"
										value="#{teamSellerBean.sellerSearch.cpf}"/>
								
								<p:commandLink title="#{msg.resolve('label.search')}" actionListener="#{teamSellerBean.findSeller}"
											process="@this, tvTeamSeller:pgroupSearchSeller" 
											update="messages, tvTeamSeller:pgroupSellerInformation">
									<h:graphicImage name="search.png" library="images"/>
								</p:commandLink>
							</h:panelGrid>	
						</h:panelGroup>
						
						<p:spacer width="20" height="10"/>
						<p:separator style="width: 400px; text-align: left;"/>
						<p:spacer width="20" height="10"/>
						
						<h:panelGroup id="pgroupSellerInformation">
							<h:panelGrid columns="5" cellpadding="5" cellspacing="5">
							
								<h:outputLabel value="#{msg.resolve('label.registry')}" for="txtSellerRegistry"/>
								<p:inputText id="txtSellerRegistry" size="10" disabled="true"
										value="#{teamSellerBean.seller.registry}"/>
							
								<h:outputLabel value="#{msg.resolve('label.cpf')}" for="txtSellerCPF"/>
								<p:inputText id="txtSellerCPF" size="15" disabled="true" 
										value="#{teamSellerBean.seller.cpfFormatted}"/>
										
								<p:spacer width="20" height="10"/>
								
								<h:outputLabel value="#{msg.resolve('label.seller.code')}" for="txtSellerCode"/>
								<p:inputText id="txtSellerCode" size="10" 
										disabled="true" value="#{teamSellerBean.seller.code}"/>	
										
								<h:outputLabel value="#{msg.resolve('label.admission')}" for="txtSellerAdmissionDate"/>
								<p:inputText id="txtSellerAdmissionDate" size="11" 
										disabled="true" value="#{teamSellerBean.seller.admission}">
									 <f:convertDateTime pattern="dd/MM/yyyy"/>
								</p:inputText>							
							</h:panelGrid>
							
							<h:panelGrid columns="2" cellpadding="5" cellspacing="5">
								<h:outputLabel value="#{msg.resolve('label.name')}" for="txtSellerName"/>
								<p:inputText id="txtSellerName" size="40" disabled="true"
										value="#{teamSellerBean.seller.name}">
									<p:spacer width="50px" height="2px"/>
								</p:inputText>		
							</h:panelGrid>
						</h:panelGroup>
						
						<h:panelGroup id="pgroupSellerSituation">
							<h:panelGrid columns="2" cellpadding="5" cellspacing="5">
								
								<h:outputLabel value="#{msg.resolve('label.situation')}" for="cbxSellerSituation">
									<p:spacer width="34px" height="2px"/>
								</h:outputLabel>
								<p:selectOneMenu id="cbxSellerSituation" value="#{teamSellerBean.sellerSituationIdSelected}" 
											requiredMessage="#{msg.resolveMsg('required.field', 'label.seller.situation')}"
											style="width: 250px" required="true">
									  <p:ajax event="change" listener="#{teamSellerBean.validateSituation(1)}"
									  		process="@this" update="tvTeamSeller:cbxSellerTransferBranch, tvTeamSeller, messages"/>
									  <f:selectItem itemLabel="#{msg.resolve('select.one.option')}"/>  
									  <f:selectItems value="#{teamSellerBean.sellerSituations}" 
									  		var="sellerSituation" itemValue="#{sellerSituation.id}"
									  		itemLabel="#{sellerSituation.name}"/> 
								</p:selectOneMenu>
								
							</h:panelGrid>
							
							<h:panelGrid columns="2" cellpadding="5" cellspacing="5" rendered="#{teamSellerBean.sellerTransfer}">
								<h:outputLabel value="#{msg.resolve('label.origin')}" for="cbxSellerTransferBranch">
									<p:spacer width="40px" height="2px"/>
								</h:outputLabel>
								<p:selectOneMenu id="cbxSellerTransferBranch" required="true" style="width: 250px;"
											 requiredMessage="#{msg.resolveMsg('required.field', 'label.seller.origin')}"
											 value="#{teamSellerBean.branchSellerTransferIdSelected}">
									<f:selectItem itemLabel="#{msg.resolve('select.one.option')}"/>  
									<f:selectItems value="#{teamSellerBean.branches}" 
											var="branch" itemValue="#{branch.id}"
											itemLabel="#{branch.code} - #{branch.name}"/>  
								</p:selectOneMenu> 
							</h:panelGrid>
							
							<h:panelGrid id="pgSellerAbsence" columns="4" cellpadding="5" cellspacing="5"
										rendered="#{teamSellerBean.absenceSeller}">
								<h:outputLabel value="#{msg.resolve('label.start.absence')}" for="cldAbsenceStart">
									<p:spacer width="20px" height="2px"/>
								</h:outputLabel>
								<p:calendar id="cldAbsenceStart" size="11" value="#{teamSellerBean.seller.absenceStart}"
										 disabled="true"/>
							
								<h:outputLabel value="#{msg.resolve('label.end.absence')}" for="cldAbsenceEnd"/>
								<p:calendar id="cldAbsenceEnd" size="11" value="#{teamSellerBean.seller.absenceStart}"
										 disabled="true" />
							</h:panelGrid>
							
						</h:panelGroup>
						
				</p:tab>
				<p:tab id="tabSupervisor" title="#{msg.resolve('tab.team.seller.supervisor.information')}"
						 rendered="#{!teamSellerBean.teamSeller.managerTeam  and teamSellerBean.branchIdSelected != null}">
				
						<p:spacer width="20" height="15"/>
						
						<h:panelGroup id="pgroupSearchSupervisor">
							<h:panelGrid columns="5" cellpadding="1" cellspacing="5">
								<h:outputLabel value="#{msg.resolve('label.registry')}" for="txtSupervisorSearchRegistry">
									<p:spacer width="32px" height="2px"/>
								</h:outputLabel>
								<p:inputText id="txtSupervisorSearchRegistry" size="10" maxlength="10"
										value="#{teamSellerBean.supervisorSearch.registry}"/>
							
								<h:outputLabel value="#{msg.resolve('label.cpf')}" for="txtSearchSupCPF"/>
								<p:inputMask id="txtSearchSupCPF" size="15" mask="999.999.999-99"
										value="#{teamSellerBean.supervisorSearch.cpf}"/>
								
								<p:commandLink title="#{msg.resolve('label.search')}" actionListener="#{teamSellerBean.findSupervisor()}"
											process="@this, pgroupSearchSupervisor" 
											update="messages, pgroupSupervisorInformation">
									<h:graphicImage name="search.png" library="images"/>
								</p:commandLink>
							</h:panelGrid>	
						</h:panelGroup>
						
						<p:spacer width="20" height="10"/>
						<p:separator style="width: 400px; text-align: left;"/>
						<p:spacer width="20" height="10"/>
						
						<h:panelGroup id="pgroupSupervisorInformation">
							<h:panelGrid columns="5" cellpadding="5" cellspacing="5">
							
								<h:outputLabel value="#{msg.resolve('label.registry')}" for="txtSellerRegistry"/>
								<p:inputText id="txtSupervisorRegistry" size="10" disabled="true"
										value="#{teamSellerBean.supervisor.registry}"/>
							
								<h:outputLabel value="#{msg.resolve('label.cpf')}" for="txtSupervisorCPF"/>
								<p:inputText id="txtSupervisorCPF" size="15" disabled="true" 
										value="#{teamSellerBean.supervisor.cpfFormatted}"/>
										
								<p:spacer width="20" height="10"/>
								
								<h:outputLabel value="#{msg.resolve('label.seller.code')}" for="txtSupervisorCode"/>
								<p:inputText id="txtSupervisorCode" size="10" 
										disabled="true" value="#{teamSellerBean.supervisor.code}"/>	
										
								<h:outputLabel value="#{msg.resolve('label.admission')}" for="txtSupervisorAdmissionDate"/>
								<p:inputText id="txtSupervisorAdmissionDate" size="11" 
										disabled="true" value="#{teamSellerBean.supervisor.admission}">
									 <f:convertDateTime pattern="dd/MM/yyyy"/>
								</p:inputText>							
							</h:panelGrid>
							
							<h:panelGrid columns="2" cellpadding="5" cellspacing="5">
								<h:outputLabel value="#{msg.resolve('label.name')}" for="txtSupervisorName"/>
								<p:inputText id="txtSupervisorName" size="40" disabled="true"
										value="#{teamSellerBean.supervisor.name}">
									<p:spacer width="50px" height="2px"/>
								</p:inputText>		
							</h:panelGrid>
						</h:panelGroup>
						
						<h:panelGroup id="pgroupSupervisorSituation">
							<h:panelGrid columns="2" cellpadding="5" cellspacing="5">
								
								<h:outputLabel value="#{msg.resolve('label.situation')}" for="cbxSupervisorSituation">
									<p:spacer width="34px" height="2px"/>
								</h:outputLabel>
								<p:selectOneMenu id="cbxSupervisorSituation" value="#{teamSellerBean.supervisorSituationIdSelected}" 
											requiredMessage="#{msg.resolveMsg('required.field', 'label.supervisor.situation')}"
											style="width: 250px" required="true" disabled="#{teamSellerBean.teamSeller.supervisorFired}">
									  <p:ajax event="change" listener="#{teamSellerBean.validateSituation(2)}"
									  		process="@this" update="pgroupSupervisorSituation, tvTeamSeller, messages"/>
									  <f:selectItem itemLabel="#{msg.resolve('select.one.option')}"/>  
									  <f:selectItems value="#{teamSellerBean.supervisorSituations}" 
									  		var="supservisorSituation" itemValue="#{supservisorSituation.id}"
									  		itemLabel="#{supservisorSituation.name}"/> 
								</p:selectOneMenu>
								
							</h:panelGrid>
							
							<h:panelGrid columns="2" cellpadding="5" cellspacing="5" rendered="#{teamSellerBean.supervisorTransfer}">
								<h:outputLabel value="#{msg.resolve('label.origin')}" for="cbxSupervisorTransferBranch">
									<p:spacer width="40px" height="2px"/>
								</h:outputLabel>
								<p:selectOneMenu id="cbxSupervisorTransferBranch" required="true" style="width: 250px;"
											 requiredMessage="#{msg.resolveMsg('required.field', 'label.seller.origin')}"
											 value="#{teamSellerBean.branchSupervisorTransferIdSelected}">
									<f:selectItem itemLabel="#{msg.resolve('select.one.option')}"/>  
									<f:selectItems value="#{teamSellerBean.branches}" 
											var="branch" itemValue="#{branch.id}"
											itemLabel="#{branch.code} - #{branch.name}"/>  
								</p:selectOneMenu> 
							</h:panelGrid>
							
							<h:panelGrid id="pgSupervisorAbsence" columns="4" cellpadding="5" cellspacing="5"
										rendered="#{teamSellerBean.absenceSupervisor}">
								<h:outputLabel value="#{msg.resolve('label.start.absence')}" for="cldSupervisorAbsenceStart">
									<p:spacer width="20px" height="2px"/>
								</h:outputLabel>
								<p:calendar id="cldSupervisorAbsenceStart" size="11" value="#{teamSellerBean.supervisor.absenceStart}"
										 disabled="#{teamSellerBean.supervisor.absenceStart != null}"/>
							
								<h:outputLabel value="#{msg.resolve('label.end.absence')}" for="cldSupervisorAbsenceEnd"/>
								<p:calendar id="cldSupervisorAbsenceEnd" size="11" value="#{teamSellerBean.supervisor.absenceStart}"
										 disabled="#{teamSellerBean.supervisor.absenceEnd != null}" />
							</h:panelGrid>
							
						</h:panelGroup>
				</p:tab>
			</p:tabView>
			
			<h:panelGrid columns="1" style="width: 100%; text-align:right !important;">
				<p:spacer width="100%" height="10"/>	
			 	<h:panelGroup>			
			 		<p:commandButton id="btnBack" immediate="true" ajax="false" 
			 				value="#{msg.resolve('label.cancel')}" image="ui-icon ui-icon-close"
			 				action="#{teamSellerBean.linkRedirect()}"/>
					
					<p:spacer width="5"/>
					
					<p:commandButton id="btnSave" process="@this, tvTeamSeller" 
							update="messages, grlMessages" image="ui-icon ui-icon-disk" oncomplete="saveCompleteHandle(xhr, status, args);"
							value="#{msg.resolve('label.save')}" actionListener="#{teamSellerBean.save}" ajax="true"/>
				</h:panelGroup>
			</h:panelGrid>
			
			<p:confirmDialog widgetVar="cdlgSaveConfirm" severity="alert" closable="false"
					header="#{msg.resolve('dialog.header.new.team.position')}" message="#{msg.resolve('dialog.message.team.position')}" >
					
				<h:panelGrid columns="1" style="width: 100%; text-align:right !important;">
				 	<h:panelGroup>			
						<p:commandButton id="btnYes" value="#{msg.resolve('label.yes')}" process="@this"
								update="tvTeamSeller, messages" oncomplete="cdlgSaveConfirm.hide()"  actionListener="#{teamSellerBean.clear}" />  
								
	       				<p:commandButton id="btnNo" value="#{msg.resolve('label.no')}" process="@this" update="messages" 
	       						oncomplete="cdlgSaveConfirm.hide()" action="#{teamSellerBean.linkRedirect}" immediate="true" ajax="false" />
					</h:panelGroup>
				</h:panelGrid>			
       				
			</p:confirmDialog>
			
			<p:dialog id="dlgAdministrative" widgetVar="dlgAdministratives" modal="true" closable="false" width="500"
						header="#{msg.resolve('dialog.header.administrative')}" resizable="false">
						
				<p:messages id="dlgMessages" showDetail="false" autoUpdate="false" closable="true" />  
				
				<p:spacer width="20" height="10"/>
			
				<h:panelGroup id="pgroupSearchAdm">
						
						<h:panelGrid columns="4" cellpadding="3" cellspacing="6">
						
							<h:outputLabel value="#{msg.resolve('label.cpf')}" for="txtSearchCPF"/>
							<p:inputMask id="txtSearchCPF" size="15" mask="999.999.999-99"
									value="#{teamSellerBean.administrativeSearch.cpf}"/>
							
							<h:outputLabel value="#{msg.resolve('label.registry')}" for="txtSearchRegistry"/>
							<p:inputText id="txtSearchRegistry" size="15" maxlength="10"
									value="#{teamSellerBean.administrativeSearch.registry}"/>
							
						</h:panelGrid>
						
						<h:panelGrid columns="3" cellpadding="1" cellspacing="3">
							<h:outputLabel value="#{msg.resolve('label.email')}" for="txtSearchEmail"/>
							<p:inputText id="txtSearchEmail" size="47" maxlength="40" 
										value="#{teamSellerBean.administrativeSearch.email}"/>
						
							<p:commandLink title="#{msg.resolve('label.add')}" actionListener="#{teamSellerBean.searchAdministrative}"
										process="@this, pgroupSearchAdm" update="dlgMessages, dtAdministratives">
									<h:graphicImage name="selecionar.png" library="images"/>
							</p:commandLink>							
						</h:panelGrid>						
				</h:panelGroup>
				
				<p:spacer width="20" height="20"/>
				
				<h:panelGroup id="pgroupAdms">
					<p:dataTable id="dtAdministratives" style="width: 98%;" 
								var="colaborator" value="#{teamSellerBean.administratives}" 
							    emptyMessage="#{msg.resolve('data.table.empty')}"  rows="5" paginator="true" paginatorAlwaysVisible="false"
								paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}" paginatorPosition="bottom">
										
							<f:facet name="header">  
					            <h:outputLabel value="#{msg.resolve('data.table.administrative.header')}" />
					        </f:facet>  
					        
					        <p:column headerText="#{msg.resolve('label.registry')}" style="text-align: center;">  
					            <h:outputText value="#{colaborator.registry}"/>  
					        </p:column> 
					        
					        <p:column headerText="#{msg.resolve('label.administrative')}" style="text-align: left;">  
					            <h:outputText value="#{colaborator.name}"/>  
					        </p:column>  
					        
					        <p:column headerText="#{msg.resolve('label.cpf')}" style="text-align: center;">  
					            <h:outputText value="#{colaborator.cpfFormatted}"/>  
					        </p:column>  
					        
					        <p:column style="text-align: center;">  
					            <p:commandLink title="#{msg.resolve('label.exclude')}" immediate="true"
					            			process="@this" update="dtAdministratives, pgroupAdms"
					            			actionListener="#{teamSellerBean.removeAdministrative(colaborator)}">
									<h:graphicImage name="delete.png" library="images"/>
								</p:commandLink>
					        </p:column>  
					</p:dataTable>
				</h:panelGroup>
				
				<p:spacer width="20" height="10"/>
				
				<h:panelGrid columns="1" style="width: 99%; text-align:right !important;">
					<p:spacer width="100%" height="10"/>	
				 	<h:panelGroup>			
						<p:commandButton id="btnOk" process="@this" update="tvTeamSeller:pgAdm" actionListener="#{teamSellerBean.renewAdmSearch}"
								value="#{msg.resolve('label.ok')}" oncomplete="dlgAdministratives.hide();" />
					</h:panelGroup>
				</h:panelGrid>
				
				<p:spacer width="20" height="10"/>
				
			</p:dialog>
		</h:form>
	</ui:define>
	
	
	 <ui:define name="script">       
        function saveCompleteHandle(xhr, status, args) {     
	        if(args.firstSave) {
	        	cdlgSaveConfirm.show();
	        }
        }
    </ui:define>
	
	
</ui:composition>
